<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>&#31532;&nbsp;3&nbsp;&#31456;&nbsp;Spring</title><link rel="stylesheet" href="css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.2"><style type="text/css">
body { background-image: url('images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }</style><link rel="start" href="index.html" title="Leona"><link rel="up" href="index.html" title="Leona"><link rel="prev" href="technique.html" title="&#31532;&nbsp;2&nbsp;&#31456;&nbsp;&#25216;&#26415;&#36873;&#22411;"><link rel="next" href="hibernate.html" title="&#31532;&nbsp;4&nbsp;&#31456;&nbsp;Hibernate"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="http://www.family168.com/" title="Family168"><img src="images/family168.png" border="0"></img></a></div><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">&#31532;&nbsp;3&nbsp;&#31456;&nbsp;Spring</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="technique.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="hibernate.html">&#19979;&#19968;&#39029;</a></td></tr></table><hr></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="spring"></a>&#31532;&nbsp;3&nbsp;&#31456;&nbsp;Spring</h2></div></div></div><p>&#26377;&#20102;spring&#65292;&#25105;&#20204;&#23601;&#19981;&#29992;&#20877;&#20889;&#24037;&#21378;&#26041;&#27861;&#65292;&#19981;&#29992;&#21457;&#24833;&#24590;&#20040;&#25226;&#20889;&#20986;&#26469;&#30340;&#21508;&#20010;&#20195;&#30721;&#35013;&#37197;&#22312;&#19968;&#36215;&#65292;&#19981;&#36807;&#25105;&#20204;&#36873;&#25321;Spring&#30340;&#21407;&#22240;&#20063;&#19981;&#20809;&#26159;&#20026;&#20102;IOC&#65292;&#32780;&#26159;&#32771;&#34385;&#21040;&#29616;&#22312;JavaEE&#20013;&#24456;&#22810;&#24320;&#28304;&#39033;&#30446;&#37117;&#25552;&#20379;&#20102;Spring&#25972;&#21512;&#20351;&#29992;&#30340;&#26041;&#27861;&#65292;&#21487;&#20197;&#20026;&#25105;&#20204;&#33410;&#30465;&#30456;&#24403;&#22810;&#30340;&#31934;&#21147;&#21644;&#26102;&#38388;&#12290;</p><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e450"></a>3.1.&nbsp;&#22312;&#39033;&#30446;&#20013;&#20351;&#29992;Spring</h2></div></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e452"></a>3.1.1.&nbsp;&#30452;&#25509;&#26500;&#36896;ApplicationContext</h3></div></div></div><p>&#22914;&#26524;&#25105;&#20204;&#21487;&#20197;applicationContext.xml&#25918;&#21040;classpath&#19979;&#65292;&#25105;&#20204;&#21487;&#20197;&#20351;&#29992;ClasspathXmlApplicationContext&#12290;&#36825;&#37324;&#20256;&#20837;&#21442;&#25968;&#30340;&#36335;&#24452;&#26159;&#30456;&#23545;&#20110;classpath&#30340;&#37197;&#32622;&#30340;&#65292;&#23545;&#20110;web&#39033;&#30446;&#23601;&#26159;WEB-INF/classes&#36825;&#20010;&#30446;&#24405;&#65292;&#25110;&#32773;WEB-INF/lib&#19979;&#20219;&#24847;&#19968;&#20010;jar&#25991;&#20214;&#19979;&#20102;&#12290;</p><pre class="programlisting">
ApplicationContext ctx = new ClasspathXmlApplicationContext("applicationContext.xml");
            </pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e456"></a>3.1.2.&nbsp;&#20351;&#29992;ContextLoaderListener</h3></div></div></div><p>&#20174;ServletContext&#21462;&#24471;web.xml&#20013;&#21021;&#22987;&#21270;&#30340;ApplicationContext</p><p>&#39318;&#20808;&#22312;web.xml&#20013;&#37197;&#32622;listener&#12290;</p><pre class="programlisting">
&lt;context-param&gt;
    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
    &lt;param-value&gt;classpath*:spring/*.xml&lt;/param-value&gt;
&lt;/context-param&gt;
&lt;listener&gt;
    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
&lt;/listener&gt;
            </pre><p>&#28982;&#21518;&#20174;ServletContext&#20013;&#33719;&#24471;ApplicationContext&#12290;</p><pre class="programlisting">
ApplicationContext context = WebApplicationContextUtils.getWebApplicationContext(application);
            </pre></div><p>&#23545;&#20110;&#26080;&#27861;&#33719;&#24471;ServletContext&#30340;&#29615;&#22659;&#65292;&#26368;&#22909;&#33258;&#23450;&#20041;&#19968;&#20010;listener&#65292;&#23558;&#29983;&#25104;&#30340;ApplicationContext&#25918;&#20837;&#19968;&#20010;&#21333;&#20363;&#20013;&#65292;&#20197;&#20415;&#26085;&#21518;&#20351;&#29992;&#12290;</p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e464"></a>3.2.&nbsp;Spring&#37197;&#32622;&#35201;&#28857;</h2></div></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e466"></a>3.2.1.&nbsp;&#22312;xml&#20013;&#20351;&#29992;spring-2.x&#30340;DTD&#12290;</h3></div></div></div><pre class="programlisting">&lt;!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN 2.0//EN" "http://www.springframework.org/dtd/spring-beans-2.0.dtd"&gt;</pre><p>&#30456;&#27604;schema&#30495;&#26159;&#26041;&#20415;&#20102;&#24456;&#22810;&#65292;&#36825;&#26679;&#21487;&#20197;&#22312;&#24517;&#39035;&#20351;&#29992;&#29305;&#23450;schema&#30340;&#26102;&#20505;&#65292;&#20877;&#35753;&#20182;&#37325;&#35013;&#19978;&#38453;&#12290;</p><p>spring-2.x&#20013;&#21435;&#25481;&#20102;singleton&#23646;&#24615;&#65292;&#20351;&#29992;scope&#23646;&#24615;&#20570;&#26367;&#20195;&#12290;&#22914;&#26524;&#36824;&#24819;&#20351;&#29992;singleton&#23646;&#24615;&#65292;&#24517;&#39035;&#37197;&#32622;&#25104;spring-1.x&#26684;&#24335;&#30340;DTD&#12290;</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">&#25552;&#31034;</h3>spring&#20013;&#24050;&#19981;&#20877;&#25512;&#33616;&#20351;&#29992;singleton&#23646;&#24615;&#65292;&#22240;&#20026;&#21333;&#20363;&#22312;&#22810;jvm&#65292;&#36828;&#31243;&#35843;&#29992;&#65292;&#38598;&#32676;&#30340;&#24773;&#20917;&#19979;&#38590;&#20197;&#25484;&#25511;&#65292;&#36824;&#26159;&#20026;&#23454;&#20363;&#25351;&#26126;&#29983;&#23384;&#30340;scope&#27604;&#36739;&#22909;&#12290;</div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e473"></a>3.2.2.&nbsp;default-lazy-init</h3></div></div></div><p>&#25042;&#24816;&#21152;&#36733;&#65292;&#31995;&#32479;&#21551;&#21160;&#30340;&#26102;&#20505;&#24182;&#19981;&#21152;&#36733;xml&#20013;&#23450;&#20041;&#30340;bean&#65292;&#32780;&#26159;&#31561;&#21040;&#23454;&#38469;&#35843;&#29992;&#30340;&#26102;&#20505;&#25165;&#21435;&#21152;&#36733;&#65292;&#36825;&#26679;&#21487;&#20197;&#32553;&#30701;&#31995;&#32479;&#21021;&#22987;&#21270;&#26102;&#38388;&#65292;&#22312;&#27979;&#35797;&#31995;&#32479;&#37096;&#20998;&#21151;&#33021;&#30340;&#24773;&#20917;&#19979;&#26377;&#26497;&#22823;&#30340;&#22909;&#22788;&#12290;</p><p>&#27880;&#24847;&#65292;PropertityPlaceHolderConfigurer&#65292;springmvc&#65292;xfire&#65292;quartz&#31561;&#30340;&#37197;&#32622;&#25991;&#20214;&#19981;&#33021;&#22768;&#26126;&#20026;&#25042;&#24816;&#21152;&#36733;&#65292;&#21542;&#21017;&#20250;&#20986;&#38382;&#39064;&#12290;</p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e477"></a>3.2.3.&nbsp;default-autowire="byName"</h3></div></div></div><p>&#25353;&#21517;&#31216;&#33258;&#21160;&#32465;&#23450;&#12290;&#35774;&#32622;&#20102;&#36825;&#20010;&#65292;&#21482;&#35201;&#23450;&#20041;bean&#30340;&#26102;&#20505;&#21517;&#31216;&#19982;&#38656;&#35201;&#32465;&#23450;&#30340;&#23646;&#24615;&#21517;&#30456;&#21516;&#65292;&#22312;&#23454;&#20363;&#21270;&#23545;&#35937;&#30340;&#26102;&#20505;&#65292;spring&#23601;&#20250;&#23558;&#36825;&#20123;&#23454;&#20363;&#33258;&#21160;&#32465;&#23450;&#65292;&#19981;&#38656;&#35201;&#20877;&#21435;&#22768;&#26126;&#32465;&#23450;&#21738;&#20123;property&#12290;&#20943;&#23569;xml&#20195;&#30721;&#37327;&#65292;&#20351;&#24471;&#32467;&#26500;&#26356;&#28165;&#26224;&#12290;</p><p>&#22312;&#20351;&#29992;compass&#30340;&#26102;&#20505;&#35201;&#27880;&#24847;&#65292;&#19981;&#33021;&#20351;&#29992;&#25353;&#21517;&#31216;&#33258;&#21160;&#32465;&#23450;&#65292;&#20250;&#33258;&#21160;&#20026;compass&#32465;&#23450;dataSource&#23548;&#33268;&#38169;&#35823;&#12290;</p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e481"></a>3.2.4.&nbsp;import</h3></div></div></div><p>&#23558;xml&#32479;&#19968;&#25918;&#22312;classpath&#19979;&#65292;&#36825;&#26679;&#26356;&#26377;&#21033;&#20110;&#36827;&#34892;&#21333;&#20803;&#27979;&#35797;&#65292;&#23545;&#20110;&#22810;&#20010;&#27169;&#22359;&#30340;xml&#20351;&#29992;import&#36827;&#34892;&#23548;&#20837;&#65292;&#23618;&#27425;&#26356;&#28165;&#26224;&#12290;</p><pre class="programlisting">
&lt;import resource="classpath:jbpm/applicationContext-jbpm4.xml"/&gt;
            </pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e485"></a>3.2.5.&nbsp;CharacterEncodingFilter</h3></div></div></div><p>spring&#25552;&#20379;&#30340;&#32534;&#30721;&#36807;&#28388;&#22120;&#65292;&#22909;&#22788;&#19968;&#26159;&#19981;&#29992;&#33258;&#24049;&#21160;&#25163;&#20889;&#20102;&#65292;&#22909;&#22788;&#20108;&#26159;&#20445;&#35777;&#27599;&#27425;&#35831;&#27714;&#21482;&#36807;&#28388;&#19968;&#27425;&#12290;&#37197;&#32622;&#22914;&#19979;&#65306;&#65288;web.xml&#65289;</p><pre class="programlisting">
&lt;filter&gt;
    &lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;encoding&lt;/param-name&gt;
        &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
            </pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e490"></a>3.2.6.&nbsp;IntrospectorCleanupListener</h3></div></div></div><p>spring&#25552;&#20379;&#30340;&#30417;&#21548;&#22120;&#65292;&#36991;&#20813;Struts&#65292;Quartz&#30340;&#20869;&#23384;&#27844;&#38706;&#23548;&#33268;ClassLoader&#19981;&#33021;&#21152;&#36733;&#12290;&#37197;&#32622;&#22914;&#19979;&#65306;&#65288;web.xml&#65289;</p><pre class="programlisting">
&lt;listener&gt;
    &lt;listener-class&gt;org.springframework.web.util.IntrospectorCleanupListener&lt;/listener-class&gt;
&lt;/listener&gt;
            </pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e495"></a>3.2.7.&nbsp;PropertyPlaceholderConfigurer</h3></div></div></div><p>&#35835;&#21462;properties&#20013;&#30340;&#21464;&#37327;&#65292;&#22312;xml&#20013;&#21487;&#20197;&#36890;&#36807;${&#21464;&#37327;&#21517;}&#30340;&#26041;&#24335;&#35843;&#29992;&#12290;&#37197;&#32622;&#22914;&#19979;&#65306;</p><pre class="programlisting">
&lt;bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"&gt;
    &lt;property name="locations"&gt;
        &lt;list&gt;
            &lt;value&gt;classpath*:conf/jdbc.properties&lt;/value&gt;
        &lt;/list&gt;
    &lt;/property&gt;
&lt;/bean&gt;

&lt;bean id="userManager" class="com.family168.manager.UserManager"&gt;
    &lt;property name="username" value="${jdbc.username}"/&gt;
&lt;/bean&gt;
            </pre></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e500"></a>3.2.8.&nbsp;PropertyOverrideConfigurer</h3></div></div></div><p>&#19982;PropertyPlaceholderConfigurer&#19981;&#21516;&#65292;PropertyOverrideConfigurer&#20250;&#22312;ApplicationContext&#21021;&#22987;&#21270;&#21518;&#65292;&#26681;&#25454;properties&#20013;&#30340;&#23450;&#20041;&#65292;&#20462;&#25913;&#23545;&#24212;&#23646;&#24615;&#30340;&#20540;&#12290;&#37197;&#32622;&#22914;&#19979;&#65306;</p><pre class="programlisting">
&lt;bean id="testPropertyConfigurer" class="org.springframework.beans.factory.config.PropertyOverrideConfigurer"&gt;
    &lt;property name="locations" value="classpath*:override.properties"/&gt;
    &lt;property name="ignoreInvalidKeys" value="true"/&gt;
&lt;/bean&gt;
            </pre><p>&#29992;&#26469;&#22312;&#27979;&#35797;&#29615;&#22659;&#19979;&#35206;&#30422;&#24050;&#26377;&#30340;&#37197;&#32622;&#65292;&#27604;&#22914;&#22312;override.properties&#20013;&#26377;userManager.username=111&#65292;&#37027;&#20040;id="userManager"&#30340;bean&#30340;username&#23646;&#24615;&#23601;&#20250;&#34987;&#20462;&#25913;&#20026;111&#12290;</p></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e506"></a>3.3.&nbsp;Spring-2.x&#23545;AOP&#21644;&#20107;&#21153;&#31649;&#29702;&#30340;&#31616;&#21270;&#37197;&#32622;</h2></div></div></div><div class="orderedlist"><ol type="1"><li><p>&#39318;&#20808;&#35201;&#20351;&#29992;schema</p><pre class="programlisting">
&lt;beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
        http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
        http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd"&gt;
                    </pre></li><li><p>&#28982;&#21518;&#35201;&#22768;&#26126;&#26631;&#35760;&#65288;&#19981;&#30693;&#36947;&#26159;&#19981;&#26159;&#24517;&#35201;&#30340;&#65289;</p><pre class="programlisting">
&lt;!-- &#25903;&#25345; @Transactional &#26631;&#35760; --&gt;
&lt;tx:annotation-driven/&gt;

&lt;!-- &#25903;&#25345; @AspectJ &#26631;&#35760;--&gt;
&lt;aop:aspectj-autoproxy/&gt;
                </pre></li><li><p>&#37197;&#32622;aop</p><pre class="programlisting">
&lt;aop:config proxy-target-class="true"&gt;
    &lt;aop:advisor pointcut="execution(* com.family168.manager..*Manager.*(..))" advice-ref="txAdvice"/&gt;
&lt;/aop:config&gt;
                </pre></li><li><p>&#37197;&#32622;txAdvice&#22788;&#29702;&#20107;&#21153;</p><pre class="programlisting">
&lt;tx:advice id="txAdvice"&gt;
    &lt;tx:attributes&gt;
        &lt;tx:method name="get*" read-only="true"/&gt;
        &lt;tx:method name="find*" read-only="true"/&gt;
        &lt;tx:method name="pagedQuery*" read-only="true"/&gt;
        &lt;tx:method name="load*" read-only="true"/&gt;
        &lt;tx:method name="*"/&gt;
    &lt;/tx:attributes&gt;
&lt;/tx:advice&gt;
                </pre></li></ol></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">&#25552;&#31034;</h3><p>name-pattern&#21315;&#19975;&#19981;&#35201;&#20889;&#25104;*..*Manager &#65292;&#36825;&#26679;&#23376;&#20250;&#25226;&#25152;&#26377;&#31532;&#19977;&#26041;&#31867;&#24211;&#30340;Manager&#27604;&#22914;Spring&#30340;PlatformTranstationManager &#20063;&#21152;&#20837;aop&#65292;&#38750;&#24120;&#21361;&#38505;&#12290;&#25152;&#20197;&#26368;&#22909;&#36824;&#26159;&#21152;&#19978;&#39033;&#30446;&#30340;package&#21069;&#32512;&#65292;&#22914;"com.family168.manager..*Manager"</p><p> &#22240;&#20026;&#26377;*&#65292;&#20250;&#20462;&#39280;&#25152;&#26377;&#26041;&#27861;&#65292;&#26377;&#20123;hibernateTemplate&#30340;final&#30340;&#26041;&#27861;&#19981;&#33021;&#34987;cglib&#20462;&#25913;&#65292;&#20250;&#25243;warning&#65292;&#26080;&#23475;&#12290;</p></div><p>&#20107;&#21153;&#23450;&#20041;&#19968;&#33324;&#40664;&#35748;&#30340;PROPAGATION_REQUIRED&#21363;&#21487;&#65292;&#21478;&#25552;&#20379;&#30340;&#20960;&#20010;&#36873;&#25321;&#24456;&#23569;&#20351;&#29992;&#12290;&#20540;&#24471;&#27880;&#24847;&#30340;&#26159;&#19968;&#20010;PROPAGATION_NESTED&#65292;&#23884;&#20837;&#24335;&#20107;&#21153;&#30340;&#24847;&#20041;&#22312;&#20110;&#22810;&#32423;&#20107;&#21153;&#65292;&#22914;&#26524;&#20986;&#38169;&#21482;rollback&#23376;&#20107;&#21153;&#33258;&#24049;&#65292;&#19981;rollback&#20027;&#20107;&#21153;&#30340;&#25152;&#26377;&#25805;&#20316;&#12290;&#36825;&#38656;&#35201;JDBC3.0 SavePoint&#21151;&#33021;&#30340;&#25903;&#25345;&#12290; &#32780;&#19968;&#33324;service&#38388;&#20114;&#30456;&#23884;&#20837;&#35843;&#29992;&#26102;&#65292;&#22914;&#26524;&#37117;&#23450;&#20041;&#20026;PROPAGATION_REQUIRED&#65292;&#26377;&#20854;&#20013;&#19968;&#20010;&#25805;&#20316;&#20986;&#38169;&#65292;rollback&#20840;&#37096;&#25805;&#20316;&#12290;</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">&#25552;&#31034;</h3><p>tx&#36825;&#20010;&#21629;&#21517;&#31354;&#38388;&#20250;&#35201;&#27714;&#21681;&#20204;&#25552;&#20379;&#19968;&#20010;&#21517;&#23383;&#20026;transactionManager&#30340;bean&#65292;&#29992;&#36825;&#20010;&#26469;&#20316;&#20026;&#40664;&#35748;&#30340;&#20107;&#21153;&#31649;&#29702;&#22120;&#12290;</p></div><p>Spring&#21442;&#32771;&#25991;&#26723; 7.3 chema-based AOP support &#25552;&#20379;&#20102;aspect,advisor,advide&#19977;&#31181;&#32452;&#35013;&#26041;&#27861;&#30340;&#35299;&#37322;&#65292;&#20854;&#20013;aspect&#26159;aspectJ&#21407;&#35013;&#65292;&#20294;&#31245;&#22797;&#26434;&#65292;</p><p>&#36825;&#37324;&#21807;&#19968;&#26377;&#28857;&#38590;&#25026;&#30340;&#26159;pointcut&#37324;&#30340;&#35821;&#27861;&#65292;&#20854;&#23454;&#20063;&#24456;&#22909;&#23398;&#65292;Spring&#21442;&#32771;&#25991;&#26723;7.2.3.4&#37324;&#26377;&#23436;&#25972;&#35828;&#26126; &#65292;&#20854;&#23454;&#19968;&#25490;&#23376;&#36807;&#21435;&#26159;</p><pre class="programlisting">
execution(modifiers-pattern? ret-type-pattern declaring-type-pattern? name-pattern(param-pattern)
      throws-pattern?)
        </pre><p>&#20854;&#20013;modifiers-pattern?(public/protected) &#21644; declaring-type-pattern? throws-pattern? &#21487;&#20197;&#19981;&#22635;</p><p>&#21487;&#35265;execution(* *..BookManager.save(..))</p><div class="itemizedlist"><ul type="disc"><li><p>&#31532;&#19968;&#39063;* &#20195;&#34920;ret-type-pattern &#36820;&#22238;&#20540;&#21487;&#20219;&#24847;&#65292;</p></li><li><p>*..*Manager &#20195;&#34920;&#20219;&#24847;Package&#37324;&#30340;&#20197;Manager&#32467;&#23614;&#30340;&#31867;&#12290;</p><p>&#22914;&#26524;&#20889;&#25104;com.xyz.service.* &#21017;&#20195;&#34920;com.xyz.service&#19979;&#30340;&#20219;&#24847;&#31867;</p><p>com.xyz.service..* com.xyz.service&#21017;&#20195;&#34920;com.xyz.service&#21450;&#20854;&#23376;package&#19979;&#30340;&#20219;&#24847;&#31867;</p></li><li><p>save&#20195;&#34920;save&#26041;&#27861;&#65292;&#20063;&#21487;&#20197;&#20889;save* &#20195;&#34920;saveBook()&#31561;&#26041;&#27861;</p><p>(..) &#21305;&#37197;0&#20010;&#21442;&#25968;&#25110;&#32773;&#22810;&#20010;&#21442;&#25968;&#30340;&#65292;&#20219;&#24847;&#31867;&#22411;</p><p>(x,..) &#31532;&#19968;&#20010;&#21442;&#25968;&#30340;&#31867;&#22411;&#24517;&#39035;&#26159;X</p><p>(x,*,*,s,..) &#21305;&#37197;&#33267;&#23569;4&#20010;&#21442;&#25968;&#65292;&#31532;&#19968;&#20010;&#21442;&#25968;&#24517;&#39035;&#26159;x&#31867;&#22411;&#65292;&#31532;&#20108;&#20010;&#21644;&#31532;&#19977;&#20010;&#21442;&#25968;&#21487;&#20197;&#20219;&#24847;&#65292;&#31532;&#22235;&#20010;&#24517;&#39035;&#26159;s&#31867;&#22411;&#12290;</p></li></ul></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e548"></a>3.4.&nbsp;Spring&#20013;&#30340;&#38646;&#37197;&#32622;</h2></div></div></div><p>&#20854;&#23454;&#20063;&#19981;&#26159;&#23436;&#20840;&#30340;&#38646;&#37197;&#32622;&#65292;&#25105;&#20204;&#38656;&#35201;&#22312;xml&#20013;&#21046;&#23450;&#35268;&#33539;&#65292;&#28982;&#21518;&#22312;java&#20013;&#20351;&#29992;&#27880;&#35299;&#36827;&#34892;&#26631;&#27880;&#12290;</p><p>&#39318;&#20808;&#35201;&#22312;xml&#20013;&#37197;&#32622;&#22914;&#19979;&#26631;&#35760;&#65306;</p><pre class="programlisting">
&lt;context:component-scan base-package="com.family168.manager" /&gt;
        </pre><p>&#36825;&#37324;&#38656;&#35201;&#20351;&#29992;Spring&#30340;schema&#21629;&#21517;&#31354;&#38388;&#36827;&#34892;&#37197;&#32622;&#65292;&#20363;&#23376;&#20013;&#20351;&#29992;&#30340;&#26159;springside&#20013;&#25552;&#20379;&#30340;&#20363;&#23376;&#65292;&#25351;&#23450;&#20102;&#40664;&#35748;&#22312;&#21738;&#20010;&#21253;&#19979;&#26597;&#25214;&#38656;&#35201;&#36827;&#34892;&#27880;&#20837;&#30340;&#31867;&#12290;&#22312;Service&#31867;&#20013;&#20351;&#29992;@Service&#27880;&#37322;&#65292; Dao&#31867;&#20013;&#20351;&#29992;@Repository&#27880;&#37322;&#65292;&#36890;&#36807;pacakge&#25195;&#25551;&#21152;&#20837;Spring&#30340;applicationContext&#12290;</p><p>&#22312;&#31169;&#26377;&#23646;&#24615;&#25110;&#27880;&#20837;&#26041;&#27861;(&#19981;&#38656;&#35201;&#20005;&#26684;&#25353;setter&#21629;&#21517;)&#19978; &#20351;&#29992;@Autowired &#27880;&#37322; &#36827;&#34892;byType&#27880;&#20837;&#65292;&#22914;&#26524;&#38656;&#35201;byName&#27880;&#20837;&#65292;&#22686;&#21152;@Qualifier&#27880;&#37322;&#12290;&#21478;@auwowired&#40664;&#35748;&#38544;&#21547;&#20102;@Required&#29305;&#24615;</p><p>&#20351;&#29992;@Required&#27880;&#37322;&#38750;@Autowired&#30340;&#23646;&#24615;&#65292;&#20445;&#35777;autowired&#19979;&#23545;&#35937;&#24517;&#28982;&#34987;&#27880;&#20837;&#65292;&#22914;&#26524;&#23545;&#35937;&#27809;&#26377;&#34987;&#27880;&#20837;&#21017;&#25253;&#38169;&#12290;&#20351;&#29992;JSR250&#30340;@PostConstruct&#26469;&#23450;&#20041;&#22312;&#25191;&#34892;&#23436;&#25152;&#26377;setter&#27880;&#20837;&#21518;&#24517;&#39035;&#25191;&#34892;&#30340;&#20989;&#25968;&#65292;&#27604;&#20197;&#24448;&#30340;&#23454;&#29616;&#25509;&#21475;&#25110;&#32773;&#22312;applicationContext.xml&#20013;&#37197;&#32622;init-method&#30340;&#26041;&#24335;&#26356;&#20026;&#26631;&#20934;&#12290;</p><p>&#20026;&#25552;&#39640;&#25928;&#29575;&#65292;&#36824;&#26159;&#38656;&#35201;&#22312;xml&#20013;&#40664;&#35748;&#37197;&#32622;default-lazy-load&#21644;default-autowire byName&#12290;</p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e557"></a>3.5.&nbsp;Spring&#20013;&#30340;&#36164;&#28304;&#35775;&#38382;</h2></div></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e559"></a>3.5.1.&nbsp;ResourceLoader</h3></div></div></div><p>ResourceLoader &#21487;&#20197;&#33719;&#24471;ClassPath, File,URL&#20013;&#30340;&#25991;&#20214;&#65292;&#36820;&#22238;&#31867;&#22411;&#20026;Resource&#30340;&#32479;&#19968;&#36164;&#28304;&#23450;&#20041;&#12290;</p><p>ApplicationContext&#20013;&#23601;&#25317;&#26377;ResourceLoader&#12290;</p><p>&#23454;&#29616;resourceLoaderAware&#25509;&#21475;&#21487;&#20197;&#33719;&#24471;ResourceLoader&#12290;</p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e564"></a>3.5.2.&nbsp;ResourcePatternResolver</h3></div></div></div><p>ResourcePatternResolver &#26159;ResourceLoader&#30340;&#21319;&#32423;&#29256;&#23376;&#25509;&#21475;&#65292;&#33021;&#35299;&#20915;ant-style&#30340;&#25991;&#20214;&#27169;&#31946;&#25209;&#37327;&#23450;&#20041;&#65292;&#22914;applicationContext-*.xml&#12290;</p><p>ApplicationContext&#20013;&#30340;ResourceLoader&#20854;&#23454;&#26159;ResourcePatternResolver &#65292;&#21487;&#20197;&#36890;&#36807;&#24378;&#21046;&#36716;&#22411;&#33719;&#24471;&#65292;&#21451;&#22909;&#19968;&#28857;&#30340;&#20570;&#27861;&#26159;&#20351;&#29992;ResourcePatternUtils&#26469;&#36716;&#25442;&#12290;</p><pre class="programlisting">
public class RescManager implements InitializingBean, BeanNameAware,
    ResourceLoaderAware {
    private ResourceLoader resourceLoader;

    public void demo() throws IOException {
        ResourcePatternResolver resolver = ResourcePatternUtils
            .getResourcePatternResolver(resourceLoader);
        Resource[] rescs = resolver.getResources(
                "classpath*:spring/applicationContext*.xml");
        System.out.println(rescs);
    }
            </pre></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e569"></a>3.6.&nbsp;Spring&#30340;&#24494;&#20869;&#26680;&#19982;FactoryBean&#25193;&#23637;&#26426;&#21046;</h2></div></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e571"></a>3.6.1.&nbsp;&#24494;&#20869;&#26680;&#30340;&#21151;&#33021;</h3></div></div></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="d4e573"></a>3.6.1.1.&nbsp;DI(&#20381;&#36182;&#27880;&#20837;)&#19982;Singleton&#31649;&#29702;</h4></div></div></div><p>&#21033;&#29992;POJO setter&#30340;DI&#26426;&#21046;&#65292;&#20272;&#35745;&#27599;&#20301;&#21516;&#23398;&#38543;&#25163;&#37117;&#33021;&#20889;&#19968;&#20010;&#31616;&#21333;&#29256;&#26412;&#65292;&#19981;&#22810;&#35828;&#20102;&#12290;</p><p>Singleton&#31649;&#29702;&#35828;&#30333;&#20102;&#23601;&#26159;&#20808;&#21040;&#19968;&#20010;map&#20013;&#25353;id&#25214;&#25214;&#30475;&#26377;&#27809;&#26377;&#24050;&#23384;&#22312;&#30340;&#23454;&#20363;&#12290;</p></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="d4e577"></a>3.6.1.2.&nbsp;BeanName&#19982;BeanFactory&#27880;&#20837;</h4></div></div></div><p>&#38500;&#20102;DI&#27880;&#20837;&#30340;&#23646;&#24615;&#65292;&#24494;&#20869;&#26680;&#36824;&#26377;&#20160;&#20040;&#33021;&#21334;&#32473;POJO&#21602;&#65311;&#23601;&#26159;Bean&#22312;xml &#23450;&#20041;&#37324;&#30340;id&#21644;BeanFactory&#33258;&#24049;&#20102;&#12290;</p><p>&#21334;&#30340;&#26426;&#21046;&#26159;&#35753;POJO &#23454;&#29616; BeanNameAware&#21644;BeanFactoryAware&#25509;&#21475;&#12290;BeanFactory&#29992; if(pojo instance of BeanFactoryAware)&#21028;&#26029;&#21040;POJO&#38656;&#35201;&#27880;&#20837;BeanFactory,&#23601;&#35843;&#29992;setBeanFactory(this)&#23558;&#33258;&#24049;&#27880;&#20837;&#12290;</p></div><div class="sect3" lang="zh-cn"><div class="titlepage"><div><div><h4 class="title"><a name="d4e581"></a>3.6.1.3.&nbsp;DI&#21518;&#30340;&#21021;&#22987;&#21270;&#20989;&#25968;&#35843;&#29992;</h4></div></div></div><p>&#27604;&#22914;&#23646;&#24615;A,B&#27880;&#20837;&#20043;&#21518;&#65292;&#38656;&#35201;&#21516;&#26102;&#26681;&#25454;A&#21644;B&#26469;&#23545;A,B&#36827;&#34892;&#21152;&#24037;&#25110;&#32773;&#35013;&#37197;&#19968;&#20010;&#20869;&#37096;&#23646;&#24615;C&#65292;&#36825;&#26679;&#23601;&#38656;&#35201;&#22312;&#25152;&#26377;&#23646;&#24615;&#27880;&#20837;&#21518;&#20877;&#36305;&#19968;&#20010;init()&#20989;&#25968;&#12290;</p><p>Spring&#25552;&#20379;&#20004;&#31181;&#26041;&#24335;&#65292;&#19968;&#31181;&#26159;&#21644;&#19978;&#38754;&#30340;&#21407;&#29702;&#19968;&#26679;&#65292;&#23454;&#29616;InitializingBean&#25509;&#21475;&#30340;afterPropertiesSet()&#20989;&#25968;&#20379;Spring&#35843;&#29992;&#12290;</p><p>&#19968;&#31181;&#26159;&#22312;xml&#23450;&#20041;&#25991;&#20214;&#37324;&#38754;&#33258;&#34892;&#23450;&#20041;init&#20989;&#25968;&#21517;&#12290;</p><p>&#25042;&#24471;&#27599;&#27425;&#22312;xml&#25991;&#20214;&#37324;&#23450;&#20041;&#30340;&#23601;&#37319;&#29992;&#31532;1&#31181;&#26041;&#24335;&#65292;&#19981;&#24819;&#19982;spring&#32806;&#21512;&#30340;pojo&#23601;&#37319;&#29992;&#31532;2&#31181;&#26041;&#24335;&#12290;&#26412;&#26469;&#23601;&#26159;&#20026;&#20102;&#25193;&#23637;Spring&#32780;&#23384;&#22312;&#30340;FactoryBean&#22810;&#37319;&#29992;&#31532;&#19968;&#31181;&#12290;</p></div><p>&#25152;&#35859;&#24494;&#20869;&#26680;&#65292;&#23601;&#26159;&#20165;&#25552;&#20379;&#20197;&#19978;&#19977;&#31181;&#21151;&#33021;&#30340;DI&#23481;&#22120;&#12290;</p></div><p>&#20294;&#20316;&#20026;&#36731;&#37327;&#32423;&#23481;&#22120;&#65292;&#36824;&#38656;&#35201;&#20197;&#19979;&#20004;&#31181;&#26041;&#24335;&#65292;&#21521;&#23481;&#22120;&#20869;&#30340;POJO &#38468;&#21152;&#21508;&#31181;&#26381;&#21153;&#12290;</p><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e589"></a>3.6.2.&nbsp;FactoryBean&#25193;&#23637;&#26426;&#21046;</h3></div></div></div><p>Spring&#30340;AOP&#12289;ORM&#12289;&#20107;&#21153;&#31649;&#29702;&#12289;JMX&#12289;Quartz&#12289;Remoting&#12289;Freemarker&#12289;Velocity&#65292;&#37117;&#38752;FacotryBean&#30340;&#25193;&#23637;&#65292;FacotryBean&#20960;&#20046;&#36941;&#24067;&#22320;&#19978;&#65306;</p><pre class="programlisting">
&lt;bean id="sessionFactory" class="org.springframework.orm.hibernate3.LocalSessionFactoryBean"/&gt;
&lt;bean id="baseDAOService" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean"/&gt;
            </pre><p>&#36825;&#21407;&#29702;&#35828;&#20986;&#26469;&#22909;&#31616;&#21333;&#65292;&#25152;&#26377;FactoryBean &#23454;&#29616;FactoryBean&#25509;&#21475;&#30340;getObject()&#20989;&#25968;&#12290;Spring&#23481;&#22120;getBean(id)&#26102;&#35265;&#21040;bean&#30340;&#23450;&#20041;&#26159;&#26222;&#36890;class&#26102;&#65292;&#23601;&#20250;&#26500;&#36896;&#35813;class&#30340;&#23454;&#20363;&#26469;&#33719;&#24471;bean&#65292;&#32780;&#22914;&#26524;&#21457;&#29616;&#26159;FactoryBean&#25509;&#21475;&#30340;&#23454;&#20363;&#26102;&#65292;&#23601;&#36890;&#36807;&#35843;&#29992;&#23427;&#30340;getObject()&#20989;&#25968;&#26469;&#33719;&#24471;bean&#65292;&#20165;&#27492;&#32780;&#20197;.......&#21487;&#35265;&#65292;&#24456;&#37325;&#35201;&#30340;&#24605;&#24819;&#65292;&#21487;&#20197;&#29992;&#24456;&#31616;&#21333;&#30340;&#35774;&#35745;&#26469;&#23454;&#29616;&#12290;</p><p>&#32771;&#23519;&#19968;&#20010;&#20856;&#22411;&#30340;FactoryBean&#65306;</p><p>&#19968;&#33324;&#20250;&#26377;&#20004;&#20010;&#21464;&#37327;&#65292;&#19977;&#20010;&#25509;&#21475;&#65306;</p><p>&#19968;&#20010;setter&#20989;&#25968;&#27880;&#20837;&#38656;&#35201;&#25913;&#35013;&#30340;pojo&#65292;&#19968;&#20010;&#20869;&#37096;&#21464;&#37327;&#20445;&#25345;&#35013;&#37197;&#21518;&#30340;&#23545;&#35937;returnOjbect&#12290;</p><p>implements&#19977;&#20010;&#25509;&#21475; &#65306;FactoryBean,InitializingBean&#21644;BeanFactoryAware &#12290;</p><p>&#21508;&#25509;&#21475;&#30340;&#24847;&#20041;&#20043;&#21069;&#37117;&#35762;&#36807;&#20102;&#12290;factoryBean&#20250;&#22312;afterPropertiesSet()&#37324;&#25226;pojo&#25913;&#35013;&#25104;returnObject&#65292;&#38656;&#35201;&#29992;&#21040;beanfactory&#36827;&#34892;&#22825;&#39532;&#34892;&#31354;&#30340;&#21160;&#20316;&#26102;&#23601;&#38752;BeanFactoryAware&#27880;&#20837;&#12290;&#26368;&#21518;&#22312;getObject()&#37324;&#25226;returnObject&#36820;&#22238;&#12290;</p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e599"></a>3.6.3.&nbsp;Bean Post-Processor&#25193;&#23637;&#26426;&#21046;</h3></div></div></div><p>&#22914;&#26524;&#35828;FactoryBean &#26159;&#19968;&#31181;Factory&#12289;Wrapper&#24335;&#30340;&#25193;&#23637;&#65292;Bean Post-Processor&#23601;&#26159;&#21478;&#19968;&#31181;AOP&#12289;visitor&#24335;&#30340;&#26426;&#21046;&#65292;&#25152;&#20197;&#20063;&#22810;&#29992;&#20110;spring&#30340;AOP&#26550;&#26500;&#12290;</p><p>Post-Processor&#30340;&#21407;&#29702;&#23601;&#26159;BeanFactory&#22312;&#21069;&#25991;&#37324;&#30340;&#35843;&#29992;afterPropertiesSet()/init-method&#21069;&#21518;&#65292;&#35843;&#29992;&#22312;&#24037;&#21378;&#37324;&#27880;&#20876;&#20102;&#30340;post-processor&#30340;postProcessBeforeInitialization()&#21644;postProcessAfterInitialization()&#12290;</p><p>&#37027;&#24590;&#20040;&#27880;&#20876;&#30331;&#35760;&#21602;&#65311;&#21448;&#20998;&#35831;&#19981;&#35831;&#31036;&#20202;&#20844;&#21496;&#20004;&#31867;&#12290;&#22914;&#26524;&#26159;ApplicationContext&#65292;&#20320;&#25226;&#32487;&#25215;BeanPostProcessor &#30340;bean&#24448;xml&#37324;&#19968;&#25601;&#23601;&#34892;&#20102;,application context&#33258;&#20250;&#25171;&#29702;&#12290;&#22914;&#26524;&#26159;BeanFacotry&#65292;&#23601;&#35201;&#26174;&#24335;&#30340;&#27880;&#20876;&#65292;&#20195;&#30721;&#22823;&#27010;&#20687;&#65306;</p><pre class="programlisting">
XmlBeanFactory factory = new XmlBeanFactory("C:/beans.xml");
BeanPostLogger logger = new BeanPostLogger();
factory.addBeanPostProcessor(logger);
            </pre></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="technique.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="hibernate.html">&#19979;&#19968;&#39029;</a></td></tr><tr><td width="40%" align="left" valign="top">&#31532;&nbsp;2&nbsp;&#31456;&nbsp;&#25216;&#26415;&#36873;&#22411;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td><td width="40%" align="right" valign="top">&nbsp;&#31532;&nbsp;4&nbsp;&#31456;&nbsp;Hibernate</td></tr></table></div></body></html>