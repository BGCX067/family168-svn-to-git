<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>&#31532;&nbsp;13&nbsp;&#31456;&nbsp;&#20219;&#21153;&#35843;&#24230;</title><link rel="stylesheet" href="css/html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.2"><style type="text/css">
body { background-image: url('images/draft.png');
       background-repeat: no-repeat;
       background-position: top left;
       /* The following properties make the watermark "fixed" on the page. */
       /* I think that's just a bit too distracting for the reader... */
       /* background-attachment: fixed; */
       /* background-position: center center; */
     }</style><link rel="start" href="index.html" title="Leona"><link rel="up" href="index.html" title="Leona"><link rel="prev" href="search.html" title="&#31532;&nbsp;12&nbsp;&#31456;&nbsp;&#20840;&#25991;&#26816;&#32034;"><link rel="next" href="jbpm.html" title="&#31532;&nbsp;14&nbsp;&#31456;&nbsp;JBPM&#24037;&#20316;&#27969;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" xmlns:fo="http://www.w3.org/1999/XSL/Format" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="http://www.family168.com/" title="Family168"><img src="images/family168.png" border="0"></img></a></div><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">&#31532;&nbsp;13&nbsp;&#31456;&nbsp;&#20219;&#21153;&#35843;&#24230;</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="search.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><th width="60%" align="center">&nbsp;</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="jbpm.html">&#19979;&#19968;&#39029;</a></td></tr></table><hr></div><div class="chapter" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title"><a name="timer"></a>&#31532;&nbsp;13&nbsp;&#31456;&nbsp;&#20219;&#21153;&#35843;&#24230;</h2></div></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e1833"></a>13.1.&nbsp;&#27010;&#36848; </h2></div></div></div><p> Quartz(http://www.opensymphony.com/quartz/)&#26159;&#26368;&#24120;&#29992;&#30340;&#23450;&#26102;&#25191;&#34892;&#20219;&#21153;&#26694;&#26550;&#65292;&#21487;&#20197;&#33258;&#34892;&#29992;API&#35774;&#23450;&#35843;&#24230;&#65292;&#20063;&#21487;&#20197;&#38598;&#25104;&#21040;Spring&#37324;&#38754;&#65292;&#20197;&#37197;&#32622;&#25991;&#20214;&#35843;&#24230;POJO&#25991;&#20214;&#30340;&#26041;&#27861;&#25191;&#34892;&#12290;</p><p>&#21442;&#32771;&#36164;&#26009;</p><p>&#12298;Quartz Job Scheduling Framework&#12299; 2006&#24180;&#26032;&#20070;&#65292;&#21487;&#20197;Emule&#24471;&#21040;&#65292;&#24456;&#22810;&#21407;&#26469;&#25991;&#26723;&#19981;&#35814;&#32454;&#30340;&#22320;&#26041;&#22914;clustering&#31561;&#37117;&#21487;&#20197;&#22312;&#37324;&#38754;&#30475;&#21040;&#12290; </p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e1838"></a>13.2.&nbsp;&#19982;Spring&#38598;&#25104;</h2></div></div></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1840"></a>13.2.1.&nbsp;Scheduler&#24635;&#20837;&#21475;</h3></div></div></div><pre class="programlisting">
&lt;bean name="quartzScheduler" class="org.springframework.scheduling.quartz.SchedulerFactoryBean"&gt;
    &lt;property name="triggers"&gt;
        &lt;list&gt;
            &lt;ref bean="cronTrigger"/&gt;
        &lt;/list&gt;
    &lt;/property&gt;
    &lt;!--&lt;property name="dataSource" ref="dataSource"/&gt; --&gt;
    &lt;property name="configLocation" value="classpath:quartz.properties"/&gt;
&lt;/bean&gt;
            </pre><p>quartz&#30340;&#35814;&#32454;&#37197;&#32622;&#22312;quartz.properties&#25991;&#20214;&#65292;&#20855;&#20307;&#37197;&#32622;&#35265;&#20854;&#27880;&#37322;&#25110;&#21442;&#32771;&#21442;&#32771;&#25991;&#26723;&#65292;&#19968;&#33324;&#40664;&#35748;&#21363;&#20026;JVM&#23884;&#20837;&#24335;Scheduler&#12290;&#20063;&#21487;&#20197;&#37197;&#32622;&#25226;&#20219;&#21153;&#25191;&#34892;&#24773;&#20917;&#23384;&#20648;&#20110;&#25968;&#25454;&#24211;&#20013;&#65292;&#21363;&#20351;&#26381;&#21153;&#22120;&#37325;&#36215;&#65292;&#20063;&#33021;&#20445;&#35777;&#20219;&#21153;&#35745;&#21010;&#27491;&#30830;&#25191;&#34892;&#12290;</p><p>&#27604;&#22914;&#23450;&#20041;12&#28857;&#36816;&#34892;&#20219;&#21153;&#30340;&#65292;&#22914;&#26524;12:05&#36816;&#34892;&#20102;&#19968;&#27425;&#65292;&#28982;&#21518;&#26381;&#21153;&#22120;&#22312;12:30&#37325;&#21551;&#65292;&#22914;&#26524;&#27809;&#26377;&#25345;&#20037;&#21270;&#65292;&#37027;&#36824;&#20250;&#37325;&#26032;&#36816;&#34892;&#19968;&#27425;&#12290;</p><p>&#21487;&#24796;hsqldb&#19981;&#25903;&#25345;select * from foo for update &#36825;&#26679;&#30340;&#34892;&#38145;&#23450;sql&#35821;&#27861;&#65292;&#26080;&#27861;demo&#12290;</p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1846"></a>13.2.2.&nbsp;Trigger</h3></div></div></div><pre class="programlisting">
&lt;bean id="cronTrigger" class="org.springframework.scheduling.quartz.CronTriggerBean"&gt;
    &lt;property name="jobDetail" ref="jobDetail"/&gt;
    &lt;!--&#26397;&#20061;&#26202;&#20116;&#24037;&#20316;&#26102;&#38388;&#20869;&#27599;&#21322;&#23567;&#26102;&#25191;&#34892;&#19968;&#27425;--&gt;
    &lt;property name="cronExpression" value="0 0/30 9-17 *,* * ?"/&gt;
&lt;/bean&gt;
            </pre><p>&#24378;&#22823;&#30340;cronTrigger&#65292;&#31867;&#20284;&#33879;&#21517;&#30340;cron&#34920;&#36798;&#24335;&#65292;&#26041;&#20415;&#25105;&#20204;&#20219;&#24847;&#30340;job&#25511;&#21046;&#30340;&#24819;&#27861;&#12290;</p><p>&#24403;&#28982;quartz&#20063;&#26377;&#31616;&#21333;&#30340;simpleTrigger&#65292;&#23454;&#29616;&#30340;&#19996;&#35199;&#23601;&#21644;jdk&#20013;&#30340;timer&#24046;&#19981;&#22810;&#20102;&#65292;&#21478;&#36824;&#26377;&#22909;&#20960;&#20010;&#20854;&#20182;&#30340;timer&#12290;&#35814;&#32454;&#35831;&#21442;&#32771;quartz &#30340;&#25991;&#26723;&#12290;</p></div><div class="sect2" lang="zh-cn"><div class="titlepage"><div><div><h3 class="title"><a name="d4e1851"></a>13.2.3.&nbsp;&#23567;&#24515;&#38519;&#38449;</h3></div></div></div><p>&#21551;&#21160;&#35745;&#21010;&#30340;FactoryBean&#20204;&#19981;&#35201;lazy-load&#65292;&#21542;&#21017;&#35745;&#21010;&#26080;&#27861;&#21551;&#21160;&#12290;</p><p>Scheduler&#19981;&#35201;Autowire&#65292;&#21542;&#21017;&#20250;&#20256;&#20837;&#19968;&#20010;DataSource/SessionFactory&#32473;Scheduler&#65292;Scheduler&#23601;&#20250;&#35748;&#20026;&#26159;&#35768;&#35201;&#25345;&#20037;&#21270;&#20219;&#21153;&#25191;&#34892;&#24773;&#20917;&#65292;&#32780;&#20854;&#23454;&#20320;&#26159;JVM&#24418;&#24335;&#25191;&#34892;&#30340;&#65292;&#23601;&#20250;&#25253;&#27809;&#26377;&#24314;&#31435;Quartz&#25345;&#20037;&#21270;&#34920;&#65292;Table or View not Found&#12290;</p></div></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e1855"></a>13.3.&nbsp;Quartz&#30456;&#23545;&#20110;JDK Timer Task&#30340;&#36827;&#27493; </h2></div></div></div><div class="itemizedlist"><ul type="disc"><li><p>&#39318;&#20808;&#26159;&#32454;&#33268;&#30340;Cron&#35821;&#27861;</p></li><li><p>&#28982;&#21518;&#26159;&#21487;&#20197;&#25226;&#20219;&#21153;&#25191;&#34892;&#24773;&#20917;&#23384;&#20648;&#20110;&#25968;&#25454;&#24211;&#20013;&#65292;&#21363;&#20351;&#26381;&#21153;&#22120;&#37325;&#36215;&#65292;&#20063;&#33021;&#20445;&#35777;&#20219;&#21153;&#35745;&#21010;&#27491;&#30830;&#25191;&#34892;&#12290;&#21487;&#24796;hsqldb&#19981;&#25903;&#25345;select * from foo for update &#36825;&#26679;&#30340;&#34892;&#38145;&#23450;sql&#35821;&#27861;&#65292;&#26080;&#27861;demo&#12290;</p></li><li><p>&#32447;&#31243;&#27744;&#24182;&#21457;&#25191;&#34892;&#30340;&#33021;&#21147;</p></li><li><p>&#32676;&#38598;&#25191;&#34892;&#30340;&#33021;&#21147;</p></li></ul></div><p>&#20197;&#19978;&#29305;&#24449;&#37117;&#21487;&#20197;&#22312;quartz&#30340;&#37197;&#32622;&#25991;&#20214;quartz.properties&#37324;&#30475;&#20986;&#26679;&#35980;&#12290;</p></div><div class="sect1" lang="zh-cn"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="d4e1867"></a>13.4.&nbsp;&#24120;&#35265;&#38382;&#39064;</h2></div></div></div><p>&#22914;&#20309;&#22312;Spring&#37197;&#32622;&#25991;&#20214;&#37324;&#22914;&#20309;&#35774;&#23450;&#23450;&#26102;&#25191;&#34892;&#20989;&#25968;&#30340;&#21442;&#25968;&#65311;</p><p>&#36825;&#26159;&#20010;&#20266;&#38382;&#39064;&#65292;&#23450;&#26102;&#25191;&#34892;&#30340;&#20989;&#25968;&#24212;&#35813;&#26159;&#26080;&#21442;&#30340;&#12290;&#27491;&#30830;&#30340;&#26041;&#27861;&#35774;&#23450;&#35813;POJO&#30340;&#25104;&#21592;&#21464;&#37327;&#65292;&#25110;&#32773;&#30001;POJO&#33258;&#34892;&#21435;&#35835;&#21462;&#26576;&#20010;&#37197;&#32622;&#25991;&#20214;&#12290;</p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="search.html">&#19978;&#19968;&#39029;</a>&nbsp;</td><td width="20%" align="center">&nbsp;</td><td width="40%" align="right">&nbsp;<a accesskey="n" href="jbpm.html">&#19979;&#19968;&#39029;</a></td></tr><tr><td width="40%" align="left" valign="top">&#31532;&nbsp;12&nbsp;&#31456;&nbsp;&#20840;&#25991;&#26816;&#32034;&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">&#36215;&#22987;&#39029;</a></td><td width="40%" align="right" valign="top">&nbsp;&#31532;&nbsp;14&nbsp;&#31456;&nbsp;JBPM&#24037;&#20316;&#27969;</td></tr></table></div></body></html>