CREATE SCHEMA PUBLIC AUTHORIZATION DBA
CREATE MEMORY TABLE DEPT(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,NAME VARCHAR(50),THE_SORT INTEGER,DESCN VARCHAR(200),PARENT_ID BIGINT,CONSTRAINT PK_DEPT PRIMARY KEY(ID),CONSTRAINT FK_DEPT_PARENT FOREIGN KEY(PARENT_ID) REFERENCES DEPT(ID))
CREATE MEMORY TABLE MENU(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,NAME VARCHAR(50),IMAGE VARCHAR(50),URL VARCHAR(50),THE_SORT INTEGER,DESCN VARCHAR(200),PARENT_ID BIGINT,CONSTRAINT PK_MENU PRIMARY KEY(ID),CONSTRAINT FK_MENU_PARENT FOREIGN KEY(PARENT_ID) REFERENCES MENU(ID))
CREATE MEMORY TABLE RESC(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,NAME VARCHAR(50),RES_TYPE VARCHAR(50),RES_STRING VARCHAR(200),DESCN VARCHAR(200),CONSTRAINT PK_RESC PRIMARY KEY(ID))
CREATE MEMORY TABLE ROLE(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,NAME VARCHAR(50),DESCN VARCHAR(200),CONSTRAINT PK_ROLE PRIMARY KEY(ID))
CREATE MEMORY TABLE USER(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL,USERNAME VARCHAR(50),PASSWORD VARCHAR(50),STATUS INTEGER,DESCN VARCHAR(200),DEPT_ID BIGINT,CONSTRAINT PK_USER PRIMARY KEY(ID),CONSTRAINT FK_USER_DEPT FOREIGN KEY(DEPT_ID) REFERENCES DEPT(ID))
CREATE MEMORY TABLE MENU_ROLE(MENU_ID BIGINT NOT NULL,ROLE_ID BIGINT NOT NULL,CONSTRAINT PK_MENU_ROLE PRIMARY KEY(MENU_ID,ROLE_ID),CONSTRAINT FK_MENU_ROLE_MENU FOREIGN KEY(MENU_ID) REFERENCES MENU(ID),CONSTRAINT FK_MENU_ROLE_ROLE FOREIGN KEY(ROLE_ID) REFERENCES ROLE(ID))
CREATE MEMORY TABLE RESC_ROLE(RESC_ID BIGINT NOT NULL,ROLE_ID BIGINT NOT NULL,CONSTRAINT PK_RESC_ROLE PRIMARY KEY(RESC_ID,ROLE_ID),CONSTRAINT FK_RESC_ROLE_RESOURCE FOREIGN KEY(RESC_ID) REFERENCES RESC(ID),CONSTRAINT FK_RESC_ROLE_ROLE FOREIGN KEY(ROLE_ID) REFERENCES ROLE(ID))
CREATE MEMORY TABLE USER_ROLE(USER_ID BIGINT NOT NULL,ROLE_ID BIGINT NOT NULL,CONSTRAINT PK_USER_ROLE PRIMARY KEY(USER_ID,ROLE_ID),CONSTRAINT FK_USER_ROLE_USER FOREIGN KEY(USER_ID) REFERENCES USER(ID),CONSTRAINT FK_USER_ROLE_ROLE FOREIGN KEY(ROLE_ID) REFERENCES ROLE(ID))
CREATE MEMORY TABLE ACL_SID(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100) NOT NULL,PRINCIPAL INTEGER,SID VARCHAR(100),CONSTRAINT PK_ACL_SID PRIMARY KEY(ID),CONSTRAINT UK_ACL_SID UNIQUE(SID,PRINCIPAL))
CREATE MEMORY TABLE ACL_CLASS(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100) NOT NULL,CLASS VARCHAR(100),CONSTRAINT PK_SCL_CLASS PRIMARY KEY(ID),CONSTRAINT UK_ACL_CLASS UNIQUE(CLASS))
CREATE MEMORY TABLE ACL_OBJECT_IDENTITY(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100) NOT NULL,OBJECT_ID_CLASS BIGINT,OBJECT_ID_IDENTITY BIGINT,PARENT_OBJECT BIGINT,OWNER_SID BIGINT,ENTRIES_INHERITING INTEGER,CONSTRAINT PK_ACL_OBJECT_IDENTITY PRIMARY KEY(ID),CONSTRAINT UK_OBJECT_IDENTITY UNIQUE(OBJECT_ID_CLASS,OBJECT_ID_IDENTITY),CONSTRAINT FK_OBJECT_IDENTITY_PARENT_OBJECT FOREIGN KEY(PARENT_OBJECT) REFERENCES ACL_OBJECT_IDENTITY(ID),CONSTRAINT FK_OBJECT_IDENTITY_OBJECT_ID_CLASS FOREIGN KEY(OBJECT_ID_CLASS) REFERENCES ACL_CLASS(ID),CONSTRAINT FK_OBJECT_IDENTITY_OWNER_SID FOREIGN KEY(OWNER_SID) REFERENCES ACL_SID(ID))
CREATE MEMORY TABLE ACL_ENTRY(ID BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100) NOT NULL,ACL_OBJECT_IDENTITY BIGINT,ACE_ORDER INTEGER,SID BIGINT,MASK INTEGER,GRANTING INTEGER,AUDIT_SUCCESS INTEGER,AUDIT_FAILURE INTEGER,CONSTRAINT PK_ACL_ENTRY PRIMARY KEY(ID),CONSTRAINT UK_ACL_ENTRY UNIQUE(ACL_OBJECT_IDENTITY,ACE_ORDER),CONSTRAINT FK_ACL_ENTRY_ACL_OBJECT_IDENTITY FOREIGN KEY(ACL_OBJECT_IDENTITY) REFERENCES ACL_OBJECT_IDENTITY(ID),CONSTRAINT FK_ACL_ENTRY_SID FOREIGN KEY(SID) REFERENCES ACL_SID(ID))
ALTER TABLE DEPT ALTER COLUMN ID RESTART WITH 1
ALTER TABLE MENU ALTER COLUMN ID RESTART WITH 1
ALTER TABLE RESC ALTER COLUMN ID RESTART WITH 1
ALTER TABLE ROLE ALTER COLUMN ID RESTART WITH 1
ALTER TABLE USER ALTER COLUMN ID RESTART WITH 2
ALTER TABLE ACL_SID ALTER COLUMN ID RESTART WITH 100
ALTER TABLE ACL_CLASS ALTER COLUMN ID RESTART WITH 100
ALTER TABLE ACL_OBJECT_IDENTITY ALTER COLUMN ID RESTART WITH 100
ALTER TABLE ACL_ENTRY ALTER COLUMN ID RESTART WITH 100
CREATE USER SA PASSWORD ""
GRANT DBA TO SA
SET WRITE_DELAY 10
SET SCHEMA PUBLIC
INSERT INTO USER VALUES(1,'test','098f6bcd4621d373cade4e832627b4f6',1,'',NULL)
